@model agenda.Models.Pessoa

@{
    ViewData["Title"] = "AgendaCAC - Criar usuário";
}

<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
<script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

<div class="wrapper">
    @if (TempData["MensagemErro"] != null)
    {
        <div class="alert alert-danger" style="text-align: center;">
            @Html.Raw(TempData["MensagemErro"])
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
    <form asp-action="Criar" asp-controller="Usuario" method="post">
        <h1>Cadastro</h1>
        <div class="input-box">
            <input type="text" id="nmPessoa" asp-for="nmPessoa" />
            @Html.ValidationMessageFor(x => x.nmPessoa)
        </div>
        <div class="input-box">
            <input asp-for="edEmail"/>
            @Html.ValidationMessageFor(x => x.edEmail)
        </div>
        <div class="input-box">
            <input type="tel" asp-for="nuTelefone" />
            @Html.ValidationMessageFor(x => x.nuTelefone)
        </div>
        <div class="input-box">
            <input type="text" asp-for="nuCPF"/>
            @Html.ValidationMessageFor(x => x.nuCPF)
        </div>
        <div class="input-box">
            <input type="text" asp-for="dtNascimento" placeholder="Data de Nascimento" style="padding-top: 10px; padding-bottom: 10px;" id="dtNascimento" />
            @Html.ValidationMessageFor(x => x.dtNascimento)
        </div>

        <div class="input-box">
            <input type="password" asp-for="coSenha" id="coSenha"/>
            @Html.ValidationMessageFor(x => x.coSenha)

        </div>
        <div class="input-box">
            <input type="password" asp-for="coSenhaConfirmar" id="coSenhaConfirmar" />
            @Html.ValidationMessageFor(x => x.coSenhaConfirmar)
        </div>
        <label style="padding-bottom: 10px;"><input type="checkbox" id="showPasswordCheckbox" /> Mostrar senha</label>
        <div class="remember-forgot" style="justify-content: space-around !important; padding: 10px; margin-bottom: -1px;">
            <label><input type="radio" asp-for="idSexo" value="2">Masculino</label>
            <label><input type="radio" asp-for="idSexo" value="1">Feminino</label>
        </div>
        <span style="position: relative; top: -10px;">
            @Html.ValidationMessageFor(x => x.idSexo)
        </span>
        <button type="submit" class="btn-login">Cadastrar</button>
        <div class="criar-conta">
            <p>Já tem uma conta?<a href="@Url.Action("Login", "Usuario")">  Entrar</a></p>
        </div>
        <input type="hidden" asp-for="icAtivo" value="true" />
    </form>
</div>

<script src="~/Scripts/moment.js" type="text/javascript"></script>
<script src="~/Scripts/shards.min.js" type="text/javascript"></script>
<script src="~/Scripts/bootstrap-datepicker.pt-BR.min.js" charset="utf-8" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>

<script type="text/javascript">
    function togglePasswordVisibility() {
        var passwordInput = document.getElementById('coSenha');
        var passwordInput1 = document.getElementById('coSenhaConfirmar');
        if (passwordInput.type === "password") {
            passwordInput.type = "text";
            passwordInput1.type = "text";
        } else {
            passwordInput.type = "password";
            passwordInput1.type = "password";
        }
    }

    document.getElementById('showPasswordCheckbox').addEventListener('click', togglePasswordVisibility);

    $(document).ready(function () {
        $('#nmPessoa').on('input', function () {
            var inputVal = $(this).val();
            var capitalized = inputVal.replace(/(^|\s)\S/g, function (t) { return t.toUpperCase(); });
            $('#nmPessoa').val(capitalized);
        });
    });

    document.addEventListener('DOMContentLoaded', function () {
        flatpickr("#dtNascimento", {
            dateFormat: "d-m-Y",
            allowInput: true
        });

        const dtNascimento = document.getElementById('dtNascimento');
        dtNascimento.addEventListener('input', function (e) {
            var value = e.target.value;
            value = value.replace(/\D/g, '') // Remove tudo que não é dígito
                .replace(/^(\d{2})(\d)/, '$1-$2') // Coloca hífen depois do dia
                .replace(/^(\d{2})-(\d{2})(\d)/, '$1-$2-$3'); // Coloca hífen depois do mês
            e.target.value = value;
        });

        dtNascimento.addEventListener('input', function (e) {
            var value = e.target.value;

            // Remove tudo que não é dígito
            value = value.replace(/\D/g, '');

            // Limita o número total de dígitos para 8 (ddmmyyyy)
            value = value.slice(0, 8);

            // Insere hífen após o dia e mês
            value = value.replace(/^(\d{2})(\d)/, '$1-$2')
                .replace(/^(\d{2})-(\d{2})(\d)/, '$1-$2-$3');

            e.target.value = value;
        });
    });

    </script>


